<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>陳主惠老師紀念網頁</title>
  <meta name="description" content="紀念陳主惠老師的網頁，包含其人生歷程、學術著作、指導論文，以及來自學生們的感念與回憶。">
  <meta name="keywords" content="陳主惠, 教授, 老師, 康乃爾大學, 水利工程, 地下水, 中國科技大學, 榮退紀念">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🌍</text></svg>">
  <link rel="stylesheet" href="css/style.css">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9H225N2CYJ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-9H225N2CYJ');
  </script>
</head>
<body>
  <div class="top-section"></div>
  <div class="bottom-section" id="content-container">
    <!-- Content will be dynamically generated by JavaScript -->
  </div>

  <script>
    function updateViewCounter() {
        const namespace = 'prof-chen-homepage';
        const key = '114-fixweb-v2';
        const counterContainer = document.createElement('div');
        counterContainer.id = 'view-counter';
        counterContainer.textContent = '瀏覽人次: 載入中...';
        document.getElementById('content-container').appendChild(counterContainer);

        fetch(`https://api.countapi.xyz/hit/${namespace}/${key}`)
            .then(response => response.json())
            .then(data => {
                counterContainer.textContent = `瀏覽人次: ${data.value}`;
            })
            .catch(error => {
                console.error('Error fetching view count:', error);
                counterContainer.textContent = '瀏覽人次: (無法取得)';
            });
    }

    document.addEventListener('DOMContentLoaded', () => {
      fetch('homepage_config.json')
        .then(response => response.json())
        .then(config => {
          const contentContainer = document.getElementById('content-container');
          
          const title = document.createElement('h1');
          title.classList.add('page-title');
          title.textContent = config.title.text;
          Object.assign(title.style, config.title.styles);

          const subtitle = document.createElement('p');
          subtitle.textContent = config.subtitle.text;
          Object.assign(subtitle.style, config.subtitle.styles);

          const buttonContainer = document.createElement('div');
          buttonContainer.className = 'button-container';

          config.links.forEach(linkInfo => {
            const link = document.createElement('a');
            link.textContent = linkInfo.text;
            link.href = linkInfo.url;
            link.className = 'cta-button';
            if (linkInfo.is_external) {
              link.target = '_blank';
              link.rel = 'noopener noreferrer';
            }
            Object.assign(link.style, linkInfo.styles);
            buttonContainer.appendChild(link);
          });

          contentContainer.appendChild(title);
          contentContainer.appendChild(subtitle);
          contentContainer.appendChild(buttonContainer);

          updateViewCounter();
        })
        .catch(error => {
          console.error('Error loading homepage config:', error);
          document.getElementById('content-container').innerHTML = '<h1 style="color:red;">網頁設定檔載入失敗</h1>';
        });
    });
  </script>
</body>
</html>
